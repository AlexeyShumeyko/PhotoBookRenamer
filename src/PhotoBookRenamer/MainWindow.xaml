<Window x:Class="PhotoBookRenamer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:PhotoBookRenamer.Utils.Converters"
        Title="PhotoBook Renamer" 
        Height="800" Width="1200"
        MinHeight="600" MinWidth="800">

    <Window.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <Window.InputBindings>
        <!-- Привязываем команды к MainViewModel, а не к CurrentViewModel -->
        <KeyBinding Key="O" Modifiers="Control" Command="{Binding OpenFilesCommand}"/>
        <KeyBinding Key="O" Modifiers="Control+Shift" Command="{Binding OpenFoldersCommand}"/>
        <KeyBinding Key="Z" Modifiers="Control" Command="{Binding UndoCommand}"/>
        <KeyBinding Key="Y" Modifiers="Control" Command="{Binding RedoCommand}"/>
        <KeyBinding Key="S" Modifiers="Control" Command="{Binding ExportCommand}"/>
        <KeyBinding Key="S" Modifiers="Control+Shift" Command="{Binding ExportWithDialogCommand}"/>
        <KeyBinding Key="E" Modifiers="Control" Command="{Binding ResetCommand}"/>
        <KeyBinding Key="D1" Modifiers="Control" Command="{Binding SwitchToUniqueFoldersCommand}"/>
        <KeyBinding Key="D2" Modifiers="Control" Command="{Binding SwitchToCombinedModeCommand}"/>
    </Window.InputBindings>

    <Grid>
        <ContentControl Content="{Binding CurrentViewModel}"/>

        <!-- Progress Overlay - привязываем IsLoading к CurrentViewModel -->
        <Grid Background="#80000000" 
              Visibility="{Binding CurrentViewModel.IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="20"/>
                <TextBlock Text="Загрузка..." Foreground="White" HorizontalAlignment="Center" Margin="0,10,0,0"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>